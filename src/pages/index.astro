---
import MainLayout from "../layouts/MainLayout.astro";
import Header from "../components/Header.astro";
import Sidebar from "../components/Sidebar.astro";
import AdvancedChart from "../components/dashboard/AdvancedChart.astro";
import KanbanBoard from "../components/dashboard/KanbanBoard.astro";
import RealTimeStats from "../components/dashboard/RealTimeStats.astro";
import PredictiveAnalytics from "../components/dashboard/PredictiveAnalytics.astro";
// import HeatmapCalendar from "../components/dashboard/HeatmapCalendar.astro";
---

<MainLayout>
  <div class="flex min-h-screen bg-gray-50 dark:bg-gray-950">
    <Sidebar />
    
    <div class="flex-1 flex flex-col overflow-hidden">
      <Header title="Dashboard Overview" />
      
      <main class="flex-1 overflow-y-auto p-4 md:p-6">
        <!-- Welcome Banner -->
        <div class="mb-6">
          <div class="bg-gradient-to-r from-primary-500 to-secondary-500 rounded-2xl p-6 text-white">
            <div class="flex flex-col lg:flex-row items-center justify-between">
              <div>
                <h1 class="text-2xl md:text-3xl font-bold">Welcome back, Omesh! ðŸ‘‹</h1>
                <p class="mt-2 opacity-90">Here's what's happening with your business today.</p>
                <div class="flex flex-wrap items-center gap-4 mt-4">
                  <div class="flex items-center space-x-2">
                    <i class="fas fa-users"></i>
                    <span>2,458 new users today</span>
                  </div>
                  <div class="flex items-center space-x-2">
                    <i class="fas fa-shopping-cart"></i>
                    <span>$24.5k in sales</span>
                  </div>
                  <div class="flex items-center space-x-2">
                    <i class="fas fa-chart-line"></i>
                    <span>+12.5% growth</span>
                  </div>
                </div>
              </div>
              <button class="mt-4 lg:mt-0 px-6 py-3 bg-white text-purple-600 font-semibold rounded-lg
               hover:bg-purple-600 hover:text-white transition-colors">
  View Detailed Report
</button>

<!-- (This is already using direct classes, so it's fine) -->
            </div>
          </div>
        </div>
        
        <!-- Quick Stats Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
          <div class="bg-white dark:bg-gray-900 rounded-xl shadow border border-gray-200 dark:border-gray-800 p-6">
            <div class="flex items-center justify-between">
              <div>
                <p class="text-sm text-gray-500 dark:text-gray-400">Total Revenue</p>
                <h3 class="text-2xl font-bold text-gray-800 dark:text-white mt-1">$24,580</h3>
                <div class="flex items-center mt-2">
                  <i class="fas fa-arrow-up text-green-500 mr-2"></i>
                  <span class="text-sm font-medium text-green-500">+12.5%</span>
                  <span class="text-gray-500 dark:text-gray-400 text-sm ml-2">from last month</span>
                </div>
              </div>
              <div class="w-14 h-14 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center">
                <i class="fas fa-dollar-sign text-white text-2xl"></i>
              </div>
            </div>
            <div class="mt-4 pt-4 border-t border-gray-100 dark:border-gray-800">
              <div class="text-xs text-gray-500 dark:text-gray-400">Daily Average</div>
              <div class="text-lg font-semibold text-gray-800 dark:text-white">$819.33</div>
            </div>
          </div>
          
          <div class="bg-white dark:bg-gray-900 rounded-xl shadow border border-gray-200 dark:border-gray-800 p-6">
            <div class="flex items-center justify-between">
              <div>
                <p class="text-sm text-gray-500 dark:text-gray-400">Active Users</p>
                <h3 class="text-2xl font-bold text-gray-800 dark:text-white mt-1">1,842</h3>
                <div class="flex items-center mt-2">
                  <i class="fas fa-arrow-up text-green-500 mr-2"></i>
                  <span class="text-sm font-medium text-green-500">+8.2%</span>
                  <span class="text-gray-500 dark:text-gray-400 text-sm ml-2">from last week</span>
                </div>
              </div>
              <div class="w-14 h-14 bg-gradient-to-br from-blue-500 to-cyan-600 rounded-xl flex items-center justify-center">
                <i class="fas fa-users text-white text-2xl"></i>
              </div>
            </div>
            <div class="mt-4 pt-4 border-t border-gray-100 dark:border-gray-800">
              <div class="text-xs text-gray-500 dark:text-gray-400">Retention Rate</div>
              <div class="text-lg font-semibold text-gray-800 dark:text-white">68.4%</div>
            </div>
          </div>
          
          <div class="bg-white dark:bg-gray-900 rounded-xl shadow border border-gray-200 dark:border-gray-800 p-6">
            <div class="flex items-center justify-between">
              <div>
                <p class="text-sm text-gray-500 dark:text-gray-400">Orders</p>
                <h3 class="text-2xl font-bold text-gray-800 dark:text-white mt-1">342</h3>
                <div class="flex items-center mt-2">
                  <i class="fas fa-arrow-down text-red-500 mr-2"></i>
                  <span class="text-sm font-medium text-red-500">-3.1%</span>
                  <span class="text-gray-500 dark:text-gray-400 text-sm ml-2">from last month</span>
                </div>
              </div>
              <div class="w-14 h-14 bg-gradient-to-br from-purple-500 to-violet-600 rounded-xl flex items-center justify-center">
                <i class="fas fa-shopping-cart text-white text-2xl"></i>
              </div>
            </div>
            <div class="mt-4 pt-4 border-t border-gray-100 dark:border-gray-800">
              <div class="text-xs text-gray-500 dark:text-gray-400">Avg. Order Value</div>
              <div class="text-lg font-semibold text-gray-800 dark:text-white">$71.87</div>
            </div>
          </div>
          
          <div class="bg-white dark:bg-gray-900 rounded-xl shadow border border-gray-200 dark:border-gray-800 p-6">
            <div class="flex items-center justify-between">
              <div>
                <p class="text-sm text-gray-500 dark:text-gray-400">Conversion Rate</p>
                <h3 class="text-2xl font-bold text-gray-800 dark:text-white mt-1">4.8%</h3>
                <div class="flex items-center mt-2">
                  <i class="fas fa-arrow-up text-green-500 mr-2"></i>
                  <span class="text-sm font-medium text-green-500">+1.7%</span>
                  <span class="text-gray-500 dark:text-gray-400 text-sm ml-2">from last quarter</span>
                </div>
              </div>
              <div class="w-14 h-14 bg-gradient-to-br from-orange-500 to-amber-600 rounded-xl flex items-center justify-center">
                <i class="fas fa-chart-line text-white text-2xl"></i>
              </div>
            </div>
            <div class="mt-4 pt-4 border-t border-gray-100 dark:border-gray-800">
              <div class="text-xs text-gray-500 dark:text-gray-400">Bounce Rate</div>
              <div class="text-lg font-semibold text-gray-800 dark:text-white">32.1%</div>
            </div>
          </div>
        </div>
        
        <!-- Main Content Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
          <AdvancedChart title="Revenue Analytics" />
          <RealTimeStats />
        </div>
        
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
          <div class="lg:col-span-2">
            <KanbanBoard />
          </div>
          <div class="space-y-6">
            <PredictiveAnalytics />
            <!-- <HeatmapCalendar /> -->
          </div>
        </div>
        
        <!-- Additional Widgets -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <!-- Server Status -->
          <div class="bg-white dark:bg-gray-900 rounded-xl shadow border border-gray-200 dark:border-gray-800 p-6">
            <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4">Server Status</h3>
            <div class="space-y-4">
              {[
                { name: 'Web Server', status: 'up', cpu: 45, memory: 68 },
                { name: 'Database', status: 'up', cpu: 28, memory: 42 },
                { name: 'Cache Server', status: 'warning', cpu: 82, memory: 75 },
                { name: 'API Gateway', status: 'up', cpu: 34, memory: 51 }
              ].map((server) => (
                <div class="flex items-center justify-between p-3 rounded-lg bg-gray-50 dark:bg-gray-800">
                  <div class="flex items-center space-x-3">
                    <div class={`w-3 h-3 rounded-full ${
                      server.status === 'up' ? 'bg-green-500' : 
                      server.status === 'warning' ? 'bg-yellow-500' : 'bg-red-500'
                    }`}></div>
                    <span class="font-medium text-gray-800 dark:text-white">{server.name}</span>
                  </div>
                  <div class="flex items-center space-x-4">
                    <div class="text-right">
                      <div class="text-sm font-medium text-gray-800 dark:text-white">{server.cpu}%</div>
                      <div class="text-xs text-gray-500 dark:text-gray-400">CPU</div>
                    </div>
                    <div class="text-right">
                      <div class="text-sm font-medium text-gray-800 dark:text-white">{server.memory}%</div>
                      <div class="text-xs text-gray-500 dark:text-gray-400">RAM</div>
                    </div>
                  </div>
                </div>
              ))}
            </div>
            <button class="w-full mt-6 px-4 py-2 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">
              View All Servers
            </button>
          </div>
          
          <!-- Recent Activity -->
          <div class="bg-white dark:bg-gray-900 rounded-xl shadow border border-gray-200 dark:border-gray-800 p-6">
            <div class="flex items-center justify-between mb-4">
              <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Recent Activity</h3>
              <button class="text-sm text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300">
                View All
              </button>
            </div>
            <div class="space-y-4">
              {[
                { user: 'Alex Johnson', action: 'Uploaded new files', time: '2 min ago', icon: 'fa-upload', color: 'text-blue-500' },
                { user: 'Sarah Miller', action: 'Created new project', time: '15 min ago', icon: 'fa-folder-plus', color: 'text-green-500' },
                { user: 'Mike Wilson', action: 'Commented on ticket', time: '1 hour ago', icon: 'fa-comment', color: 'text-purple-500' },
                { user: 'Emma Davis', action: 'Updated profile', time: '2 hours ago', icon: 'fa-user-edit', color: 'text-yellow-500' },
                { user: 'David Lee', action: 'Completed payment', time: '5 hours ago', icon: 'fa-credit-card', color: 'text-green-500' }
              ].map((activity) => (
                <div class="flex items-start space-x-3">
                  <div class={`${activity.color} w-10 h-10 rounded-full bg-opacity-10 flex items-center justify-center`}>
                    <i class={`fas ${activity.icon}`}></i>
                  </div>
                  <div class="flex-1">
                    <p class="text-sm text-gray-800 dark:text-white">
                      <span class="font-medium">{activity.user}</span> {activity.action}
                    </p>
                    <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">{activity.time}</p>
                  </div>
                </div>
              ))}
            </div>
          </div>
          
          <!-- Quick Actions -->
          <div class="bg-white dark:bg-gray-900 rounded-xl shadow border border-gray-200 dark:border-gray-800 p-6">
            <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4">Quick Actions</h3>
            <div class="grid grid-cols-2 gap-3">
              <button class="flex flex-col items-center justify-center p-4 bg-blue-50 dark:bg-gray-800 rounded-xl hover:bg-blue-100 dark:hover:bg-gray-700 transition-colors">
                <i class="fas fa-plus text-blue-500 text-xl mb-2"></i>
                <span class="text-sm font-medium text-gray-800 dark:text-white">New Task</span>
              </button>
              <button class="flex flex-col items-center justify-center p-4 bg-green-50 dark:bg-gray-800 rounded-xl hover:bg-green-100 dark:hover:bg-gray-700 transition-colors">
                <i class="fas fa-chart-bar text-green-500 text-xl mb-2"></i>
                <span class="text-sm font-medium text-gray-800 dark:text-white">Reports</span>
              </button>
              <button class="flex flex-col items-center justify-center p-4 bg-purple-50 dark:bg-gray-800 rounded-xl hover:bg-purple-100 dark:hover:bg-gray-700 transition-colors">
                <i class="fas fa-users text-purple-500 text-xl mb-2"></i>
                <span class="text-sm font-medium text-gray-800 dark:text-white">Team</span>
              </button>
              <button class="flex flex-col items-center justify-center p-4 bg-yellow-50 dark:bg-gray-800 rounded-xl hover:bg-yellow-100 dark:hover:bg-gray-700 transition-colors">
                <i class="fas fa-cog text-yellow-500 text-xl mb-2"></i>
                <span class="text-sm font-medium text-gray-800 dark:text-white">Settings</span>
              </button>
              <button class="flex flex-col items-center justify-center p-4 bg-red-50 dark:bg-gray-800 rounded-xl hover:bg-red-100 dark:hover:bg-gray-700 transition-colors">
                <i class="fas fa-download text-red-500 text-xl mb-2"></i>
                <span class="text-sm font-medium text-gray-800 dark:text-white">Export</span>
              </button>
              <button class="flex flex-col items-center justify-center p-4 bg-indigo-50 dark:bg-gray-800 rounded-xl hover:bg-indigo-100 dark:hover:bg-gray-700 transition-colors">
                <i class="fas fa-question-circle text-indigo-500 text-xl mb-2"></i>
                <span class="text-sm font-medium text-gray-800 dark:text-white">Help</span>
              </button>
            </div>
          </div>
        </div>
      </main>
      
      <!-- Footer -->
      <footer class="border-t border-gray-200 dark:border-gray-800 bg-white dark:bg-gray-900 px-6 py-4">
        <div class="flex flex-col md:flex-row items-center justify-between">
          <div class="text-sm text-gray-500 dark:text-gray-400">
            Â© 2024 ProDash Analytics. All rights reserved.
          </div>
          <div class="flex items-center space-x-6 mt-2 md:mt-0">
            <a href="#" class="text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300">Privacy</a>
            <a href="#" class="text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300">Terms</a>
            <a href="#" class="text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300">Cookies</a>
            <div class="flex items-center space-x-4">
              <a href="#" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                <i class="fab fa-twitter"></i>
              </a>
              <a href="#" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                <i class="fab fa-linkedin"></i>
              </a>
              <a href="#" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                <i class="fab fa-github"></i>
              </a>
            </div>
          </div>
        </div>
      </footer>
    </div>
  </div>
</MainLayout>

<script>
  // Initialize real-time updates
  document.addEventListener('DOMContentLoaded', function() {
    // Simulate real-time data updates
    setInterval(() => {
      // Update stats
      const stats = document.querySelectorAll('.stat-value');
      stats.forEach(stat => {
        const current = parseInt(stat.textContent.replace(/[^0-9]/g, ''));
        const change = Math.floor(Math.random() * 100) - 50;
        const newValue = Math.max(0, current + change);
        stat.textContent = newValue.toLocaleString();
        
        // Animate the change
        stat.style.transform = 'scale(1.1)';
        setTimeout(() => {
          stat.style.transform = 'scale(1)';
        }, 300);
      });
    }, 10000);
    
    // Initialize tooltips
    const tooltips = document.querySelectorAll('[data-tooltip]');
    tooltips.forEach(el => {
      el.addEventListener('mouseenter', function(e) {
        const tooltip = document.createElement('div');
        tooltip.className = 'fixed z-50 px-3 py-2 text-sm bg-gray-900 dark:bg-gray-800 text-white rounded-lg shadow-lg';
        tooltip.textContent = this.getAttribute('data-tooltip');
        document.body.appendChild(tooltip);
        
        const rect = this.getBoundingClientRect();
        tooltip.style.left = rect.left + 'px';
        tooltip.style.top = (rect.top - tooltip.offsetHeight - 10) + 'px';
        
        this._tooltip = tooltip;
      });
      
      el.addEventListener('mouseleave', function() {
        if (this._tooltip) {
          this._tooltip.remove();
          this._tooltip = null;
        }
      });
    });
  });
</script>