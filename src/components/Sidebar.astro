---
import { themeStore } from '../../stores/theme.astro.js';

const mainMenu = [
  { 
    title: "Dashboard", 
    icon: "fas fa-home", 
    active: true,
    submenu: [
      { label: "Overview", path: "/" },
      { label: "Analytics", path: "/analytics" },
      { label: "E-commerce", path: "/ecommerce" },
      { label: "CRM", path: "/crm" }
    ]
  },
  { 
    title: "Analytics", 
    icon: "fas fa-chart-line",
    badge: "5",
    submenu: [
      { label: "Revenue", path: "/analytics/revenue" },
      { label: "Traffic", path: "/analytics/traffic" },
      { label: "Conversions", path: "/analytics/conversions" },
      { label: "Retention", path: "/analytics/retention" }
    ]
  },
  { 
    title: "Users", 
    icon: "fas fa-users",
    count: "2.4k",
    submenu: [
      { label: "All Users", path: "/users" },
      { label: "User Groups", path: "/users/groups" },
      { label: "Permissions", path: "/users/permissions" },
      { label: "Activity Log", path: "/users/activity" }
    ]
  },
  { 
    title: "Orders", 
    icon: "fas fa-shopping-cart",
    badge: "12",
    submenu: [
      { label: "All Orders", path: "/orders" },
      { label: "Pending", path: "/orders/pending" },
      { label: "Completed", path: "/orders/completed" },
      { label: "Returns", path: "/orders/returns" }
    ]
  },
  { 
    title: "Products", 
    icon: "fas fa-box",
    submenu: [
      { label: "Inventory", path: "/products" },
      { label: "Categories", path: "/products/categories" },
      { label: "Attributes", path: "/products/attributes" },
      { label: "Reviews", path: "/products/reviews" }
    ]
  },
  { 
    title: "Finance", 
    icon: "fas fa-wallet",
    submenu: [
      { label: "Transactions", path: "/finance" },
      { label: "Invoices", path: "/finance/invoices" },
      { label: "Taxes", path: "/finance/taxes" },
      { label: "Reports", path: "/finance/reports" }
    ]
  }
];

const secondaryMenu = [
  { title: "Settings", icon: "fas fa-cog", path: "/settings" },
  { title: "Help Center", icon: "fas fa-life-ring", path: "/help" },
  { title: "Documentation", icon: "fas fa-book", path: "/docs" }
];
---

<aside 
  id="sidebar" 
  class="fixed lg:static inset-y-0 left-0 z-40 w-64 bg-white dark:bg-gray-900 border-r border-gray-200 dark:border-gray-800 h-screen lg:block transition-all duration-300"
  :class="{ 'hidden lg:block': !themeStore.sidebarCollapsed, 'lg:w-20': themeStore.sidebarCollapsed }"
>
  <!-- Logo -->
  <div class="p-6 border-b border-gray-200 dark:border-gray-800 flex items-center justify-between">
    <div class="flex items-center space-x-3" :class="{ 'lg:hidden': themeStore.sidebarCollapsed }">
      <div class="w-10 h-10 bg-gradient-to-br from-primary-500 to-secondary-500 rounded-xl flex items-center justify-center">
        <i class="fas fa-chart-network text-white text-xl"></i>
      </div>
      <h2 class="text-xl font-bold text-gray-800 dark:text-white">ProDash</h2>
    </div>
    <button 
      onclick="themeStore.toggleSidebar()"
      class="hidden lg:flex items-center justify-center w-8 h-8 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800"
    >
      <i class="fas fa-chevron-left text-gray-500 dark:text-gray-400" :class="{ 'rotate-180': themeStore.sidebarCollapsed }"></i>
    </button>
  </div>

  <!-- Search -->
  <div class="p-4 border-b border-gray-200 dark:border-gray-800" :class="{ 'lg:hidden': themeStore.sidebarCollapsed }">
    <div class="relative">
      <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 dark:text-gray-500"></i>
      <input
        type="text"
        placeholder="Search menu..."
        class="w-full pl-10 pr-4 py-2 bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-sm"
      />
    </div>
  </div>

  <!-- Navigation -->
  <div class="p-4 flex-1 overflow-y-auto">
    <nav class="space-y-1">
      {mainMenu.map((item) => (
        <div class="group">
          <a
            href="#"
            class={`flex items-center justify-between px-4 py-3 rounded-lg transition-all ${
              item.active
                ? "bg-primary-50 dark:bg-gray-800 text-primary-600 dark:text-primary-400 font-medium"
                : "text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800"
            }`}
          >
            <div class="flex items-center space-x-3">
              <i class={`${item.icon} w-5 text-center`}></i>
              <span :class="{ 'lg:hidden': themeStore.sidebarCollapsed }">{item.title}</span>
            </div>
            <div class="flex items-center space-x-2" :class="{ 'lg:hidden': themeStore.sidebarCollapsed }">
              {item.badge && (
                <span class="px-2 py-1 text-xs font-medium bg-red-100 dark:bg-red-900 text-red-600 dark:text-red-300 rounded-full">
                  {item.badge}
                </span>
              )}
              {item.count && (
                <span class="text-xs text-gray-500 dark:text-gray-400">{item.count}</span>
              )}
              <i class="fas fa-chevron-down text-xs transition-transform group-hover:rotate-180"></i>
            </div>
          </a>
          
          <!-- Submenu -->
          <div class="ml-4 pl-8 mt-1 space-y-1 border-l border-gray-200 dark:border-gray-700 hidden group-hover:block lg:group-hover:block">
            {item.submenu.map((sub) => (
              <a
                href={sub.path}
                class="flex items-center space-x-3 px-4 py-2 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800"
              >
                <i class="fas fa-circle text-xs opacity-50"></i>
                <span>{sub.label}</span>
              </a>
            ))}
          </div>
        </div>
      ))}
    </nav>
    
    <!-- Divider -->
    <div class="my-6 border-t border-gray-200 dark:border-gray-800"></div>
    
    <!-- Secondary Menu -->
    <nav class="space-y-1">
      {secondaryMenu.map((item) => (
        <a
          href={item.path}
          class="flex items-center space-x-3 px-4 py-3 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg transition-colors"
        >
          <i class={`${item.icon} w-5 text-center`}></i>
          <span :class="{ 'lg:hidden': themeStore.sidebarCollapsed }">{item.title}</span>
        </a>
      ))}
    </nav>
  </div>

  <!-- User Card -->
  <div class="p-4 border-t border-gray-200 dark:border-gray-800" :class="{ 'lg:hidden': themeStore.sidebarCollapsed }">
    <div class="bg-gradient-to-r from-primary-50 to-secondary-50 dark:from-gray-800 dark:to-gray-800 rounded-xl p-4">
      <div class="flex items-center space-x-3">
        <div class="w-12 h-12 bg-gradient-to-br from-primary-500 to-secondary-500 rounded-full flex items-center justify-center">
          <i class="fas fa-crown text-white"></i>
        </div>
        <div>
          <p class="font-semibold text-gray-800 dark:text-white">Pro Plan</p>
          <p class="text-sm text-gray-600 dark:text-gray-400">Expires in 24 days</p>
        </div>
      </div>
      <div class="mt-4">
        <div class="flex justify-between text-sm mb-1">
          <span class="text-gray-600 dark:text-gray-400">Storage</span>
          <span class="font-medium text-gray-800 dark:text-white">8.2/12 GB</span>
        </div>
        <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
          <div 
            class="bg-gradient-to-r from-primary-500 to-secondary-500 h-2 rounded-full" 
            style="width: 68%"
          ></div>
        </div>
      </div>
      <button class="w-full mt-4 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 text-gray-800 dark:text-white py-2 rounded-lg text-sm font-medium hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
        Upgrade Plan
      </button>
    </div>
  </div>
</aside>

<script>
  // Initialize theme store
  themeStore.init();
</script>